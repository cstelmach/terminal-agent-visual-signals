#!/bin/bash
# ==============================================================================
# TAVS - Terminal Agent Visual Signals â€” Master Defaults
# ==============================================================================
# Single source of truth for all configuration.
#
# Structure:
#   1. Global settings (apply to all agents)
#   2. Default colors (fallback when agent has no specific colors)
#   3. Agent-specific settings (AGENT_PREFIX_ variables)
#   4. Unknown agent fallback
#
# Override Priority: User (~/.tavs/user.conf) > This file
# ==============================================================================

# ==============================================================================
# RUNTIME DISABLE (Environment Variable)
# ==============================================================================
# Set TAVS_STATUS=false to disable visual signals at runtime.
# Recognized disabled values (case-insensitive): false, 0, off, no, disabled
# This is an environment variable, not a config option.

# ==============================================================================
# GLOBAL SETTINGS
# ==============================================================================
# These apply to all agents unless overridden with AGENT_PREFIX_ variables.

# Operating Mode
# Options: "static" (hardcoded colors), "dynamic" (query terminal), "preset"
THEME_MODE="static"

# For preset mode, specify which preset to use
# Available: catppuccin-latte, catppuccin-frappe, catppuccin-macchiato, catppuccin-mocha
#            nord, dracula, solarized-dark, solarized-light, tokyo-night
THEME_PRESET=""

# ==============================================================================
# LIGHT/DARK MODE SETTINGS
# ==============================================================================
#
# ENABLE_LIGHT_DARK_SWITCHING - Detect system light/dark mode automatically
#   "false" - (Default) Always use dark backgrounds
#   "true"  - Switch between light/dark based on system appearance (macOS/Linux)
#
# FORCE_MODE - Override auto-detection with explicit mode
#   "auto"  - (Default) Use auto-detection if enabled, otherwise dark
#   "dark"  - Always use dark mode colors
#   "light" - Always use light mode colors
#
# TRUECOLOR_MODE_OVERRIDE - Special handling for TrueColor terminals
#   TrueColor terminals (COLORTERM=truecolor) have their own color schemes.
#   This setting controls whether TAVS should respect that or override it.
#
#   "off"   - (Default) In TrueColor, skip auto dark mode and always use dark.
#             This respects your terminal's color scheme.
#   "muted" - Allow light/dark switching but use muted colors (reduced contrast).
#             Muted dark is lighter, muted light is darker - they converge.
#   "full"  - Allow light/dark switching with regular colors (may clash with
#             your terminal's color scheme).
#
# How these settings interact:
#   1. FORCE_MODE="dark" or "light" always wins (explicit override)
#   2. If ENABLE_LIGHT_DARK_SWITCHING="false", always dark mode
#   3. If ENABLE_LIGHT_DARK_SWITCHING="true" and in TrueColor:
#      - TRUECOLOR_MODE_OVERRIDE="off"   â†’ dark mode (respects terminal)
#      - TRUECOLOR_MODE_OVERRIDE="muted" â†’ auto-detect with muted colors
#      - TRUECOLOR_MODE_OVERRIDE="full"  â†’ auto-detect with regular colors
#   4. If ENABLE_LIGHT_DARK_SWITCHING="true" and NOT in TrueColor:
#      - Always auto-detect system mode
#
ENABLE_LIGHT_DARK_SWITCHING="false"
FORCE_MODE="auto"
TRUECOLOR_MODE_OVERRIDE="off"

# Feature Toggles
ENABLE_BACKGROUND_CHANGE="true"
ENABLE_TITLE_PREFIX="true"
ENABLE_PROCESSING="true"
ENABLE_PERMISSION="true"
ENABLE_COMPLETE="true"
ENABLE_IDLE="true"
ENABLE_COMPACTING="true"
ENABLE_SUBAGENT="true"       # NEW: Visual feedback when Task tool spawns subagents
ENABLE_TOOL_ERROR="true"     # NEW: Visual feedback on tool execution failures
ENABLE_MODE_AWARE_PROCESSING="${ENABLE_MODE_AWARE_PROCESSING:-true}"  # Subtle processing color shift by permission mode

# ==============================================================================
# TERMINAL TITLE MODE
# ==============================================================================
# Controls how TAVS handles terminal tab titles when used with Claude Code.
# Claude Code sets its own animated spinner title during processing.
#
# Options:
#   "full"            - TAVS owns all titles including processing
#                       (requires CLAUDE_CODE_DISABLE_TERMINAL_TITLE=1 in Claude settings)
#   "prefix-only"     - TAVS adds face+emoji prefix, preserves user's base title
#                       (best for users who name their tabs)
#   "skip-processing" - Let Claude Code handle processing titles, TAVS handles others (DEFAULT)
#                       (safe default, no conflict with Claude's spinner)
#   "off"             - No title changes at all, only colors/backgrounds
TAVS_TITLE_MODE="skip-processing"

# ==============================================================================
# TITLE BASE FALLBACK
# ==============================================================================
# When no user-set title is detected, TAVS uses a fallback for the base title.
#
# Options:
#   "session-path" - Session ID prefix + path: "134eed79 ~/projects"
#   "path-session" - Path + session ID suffix: "~/projects 134eed79"
#   "session"      - Session ID only: "134eed79"
#   "path"         - Path only (current behavior): "~/projects"
TAVS_TITLE_FALLBACK="path"

# ==============================================================================
# TITLE FORMAT TEMPLATE
# ==============================================================================
# Customize the title composition. Placeholders:
#   {FACE}         - Agent face (e.g., "Æ[â€¢ â€¢]E")
#   {STATUS_ICON}  - State status icon (e.g., "ğŸŸ ")
#   {AGENTS}       - Active subagent count (e.g., "+2") - empty when none
#   {SESSION_ICON} - Session icon (e.g., "ğŸ™") - unique per terminal tab, empty when disabled
#   {BASE}         - Base title (user-set or fallback)
#
# Examples:
#   "{FACE} {STATUS_ICON} {AGENTS} {SESSION_ICON} {BASE}" -> "Æ[â€¢ â€¢]E ğŸŸ  +2 ğŸ™ ~/project" (default)
#   "{FACE} {STATUS_ICON} {AGENTS} {SESSION_ICON}"        -> "Æ[â€¢ â€¢]E ğŸŸ  +2 ğŸ™" (no path)
#   "{STATUS_ICON} {SESSION_ICON} {BASE}"                  -> "ğŸŸ  ğŸ™ ~/project" (minimal)
#   "{FACE} {STATUS_ICON} {AGENTS} {BASE}"                 -> "Æ[â€¢ â€¢]E ğŸŸ  +2 ~/project" (no icon)
TAVS_TITLE_FORMAT="{FACE} {STATUS_ICON} {AGENTS} {SESSION_ICON} {BASE}"

# Subagent count format in title. {N} = count number.
# Only shown when count > 0. Empty string = hide counter entirely.
# Examples: "+{N}" (concise), "+{N} subagents" (verbose), "({N})" (parens)
TAVS_AGENTS_FORMAT="+{N}"

# ==============================================================================
# TITLE PRESETS
# ==============================================================================
# Quick-switch between pre-built title format configurations.
# When set, overrides TAVS_FACE_MODE and all TAVS_TITLE_FORMAT_* variables.
# Set via: ./tavs set title-preset <name>
#
# Values:
#   ""          - No preset (use explicit format variables below)
#   "compact"   - Emoji eyes: state+context in face, guillemet identity
#                 Example: Æ[ğŸŸ§ ğŸ§€]E +2 Â«ğŸ‡©ğŸ‡ª|ğŸ¦ŠÂ» ~/proj
#   "dashboard" - Text faces: rich info group in parentheses after face
#                 Example: Æ[â€¢ â€¢]EË™Â°(ğŸŸ |ğŸ§€|ğŸ‡©ğŸ‡ª|ğŸ¦Š) +2 75% ~/proj  abc123de
TAVS_TITLE_PRESET=""

# ==============================================================================
# PER-STATE TITLE FORMATS
# ==============================================================================
# Override TAVS_TITLE_FORMAT for specific trigger states.
# Empty string = fall back to TAVS_TITLE_FORMAT.
# Available tokens: {FACE} {STATUS_ICON} {AGENTS} {SESSION_ICON} {BASE}
#   plus identity: {DIR_ICON} {SESSION_ID}
#   plus context: {CONTEXT_PCT} {CONTEXT_FOOD} {CONTEXT_FOOD_10} {CONTEXT_ICON}
#   {CONTEXT_BAR_H} {CONTEXT_BAR_HL} {CONTEXT_BAR_V} {CONTEXT_BAR_VM}
#   {CONTEXT_BRAILLE} {CONTEXT_NUMBER}
#   plus metadata: {MODEL} {COST} {DURATION} {LINES} {MODE}
TAVS_TITLE_FORMAT_PROCESSING=""
TAVS_TITLE_FORMAT_PERMISSION="{FACE} {STATUS_ICON} {SESSION_ICON} {CONTEXT_FOOD}{CONTEXT_PCT} {BASE}"
TAVS_TITLE_FORMAT_COMPLETE="{FACE} {STATUS_ICON} {CONTEXT_FOOD}{CONTEXT_PCT} {SESSION_ICON} {BASE}"
TAVS_TITLE_FORMAT_IDLE="{FACE} {STATUS_ICON} {CONTEXT_FOOD}{CONTEXT_PCT} {SESSION_ICON} {BASE}"
TAVS_TITLE_FORMAT_COMPACTING="{FACE} {STATUS_ICON} {CONTEXT_PCT} {BASE}"
TAVS_TITLE_FORMAT_SUBAGENT=""
TAVS_TITLE_FORMAT_TOOL_ERROR=""
TAVS_TITLE_FORMAT_RESET=""

# ==============================================================================
# CONTEXT DATA BRIDGE
# ==============================================================================
# StatusLine bridge writes context data to state file for title tokens.
# Max age before bridge data is considered stale (seconds).
TAVS_CONTEXT_BRIDGE_MAX_AGE=30
# Default context window size (tokens) for percentage calculation.
# Per-agent override: CLAUDE_CONTEXT_WINDOW_SIZE, GEMINI_CONTEXT_WINDOW_SIZE, etc.
# Auto-detected from model ID when parsing JSONL transcripts.
TAVS_CONTEXT_WINDOW_SIZE=200000
DEFAULT_CONTEXT_WINDOW_SIZE=200000
CLAUDE_CONTEXT_WINDOW_SIZE=200000
GEMINI_CONTEXT_WINDOW_SIZE=1000000

# ==============================================================================
# CONTEXT DISPLAY ICON ARRAYS
# ==============================================================================
# All arrays can be overridden in ~/.tavs/user.conf

# Bar characters for horizontal progress bars
TAVS_CONTEXT_BAR_FILL="â–“"
TAVS_CONTEXT_BAR_EMPTY="â–‘"
TAVS_CONTEXT_BAR_MAX="â–’"

# Food Scale â€” 21-stage (5% steps) â€” DEFAULT for {CONTEXT_FOOD}
# Lookup: index = pct / 5 (clamped to 0-20)
TAVS_CONTEXT_FOOD_21=(
    "ğŸ’§"    # 0%
    "ğŸ¥¬"    # 5%
    "ğŸ¥¦"    # 10%
    "ğŸ¥’"    # 15%
    "ğŸ¥—"    # 20%
    "ğŸ¥"    # 25%
    "ğŸ¥‘"    # 30%
    "ğŸ‹"    # 35%
    "ğŸŒ"    # 40%
    "ğŸŒ½"    # 45%
    "ğŸ§€"    # 50%
    "ğŸ¥¨"    # 55%
    "ğŸ"    # 60%
    "ğŸ¥ª"    # 65%
    "ğŸŒ®"    # 70%
    "ğŸ•"    # 75%
    "ğŸŒ­"    # 80%
    "ğŸ”"    # 85%
    "ğŸŸ"    # 90%
    "ğŸ©"    # 95%
    "ğŸ«"    # 100%
)

# Food Scale â€” 11-stage (10% steps) â€” for {CONTEXT_FOOD_10}
# Lookup: index = pct / 10 (clamped to 0-10)
TAVS_CONTEXT_FOOD_11=(
    "ğŸ’§"    # 0%
    "ğŸ¥¬"    # 10%
    "ğŸ¥¦"    # 20%
    "ğŸ¥‘"    # 30%
    "ğŸŒ"    # 40%
    "ğŸ§€"    # 50%
    "ğŸ"    # 60%
    "ğŸŒ®"    # 70%
    "ğŸ”"    # 80%
    "ğŸŸ"    # 90%
    "ğŸ«"    # 100%
)

# Color Circle Scale â€” 11-stage (10% steps) â€” for {CONTEXT_ICON}
# Lookup: index = pct / 10 (clamped to 0-10)
TAVS_CONTEXT_CIRCLES_11=(
    "âšª"    # 0%
    "ğŸ”µ"    # 10%
    "ğŸ”µ"    # 20%
    "ğŸŸ¢"    # 30%
    "ğŸŸ¢"    # 40%
    "ğŸŸ¡"    # 50%
    "ğŸŸ "    # 60%
    "ğŸŸ "    # 70%
    "ğŸ”´"    # 80%
    "ğŸ”´"    # 90%
    "âš«"    # 100%
)

# Number Emoji Scale â€” 11-stage (10% steps) â€” for {CONTEXT_NUMBER}
# Lookup: index = pct / 10 (clamped to 0-10)
TAVS_CONTEXT_NUMBERS=(
    "0ï¸âƒ£" "1ï¸âƒ£" "2ï¸âƒ£" "3ï¸âƒ£" "4ï¸âƒ£"
    "5ï¸âƒ£" "6ï¸âƒ£" "7ï¸âƒ£" "8ï¸âƒ£" "9ï¸âƒ£" "ğŸ”Ÿ"
)

# Block Characters â€” 8-stage â€” for {CONTEXT_BAR_V}
# Lookup: index = pct * 7 / 100 (clamped to 0-7)
TAVS_CONTEXT_BLOCKS=("â–" "â–‚" "â–ƒ" "â–„" "â–…" "â–†" "â–‡" "â–ˆ")

# Braille Characters â€” 7-stage (bottom to top fill) â€” for {CONTEXT_BRAILLE}
# Lookup: index = pct * 6 / 100 (clamped to 0-6)
TAVS_CONTEXT_BRAILLE=("â €" "â „" "â ¤" "â ´" "â ¶" "â ·" "â ¿")

# ==============================================================================
# SESSION ICONS
# ==============================================================================
# Unique animal emoji per terminal tab for visual session identification.
# Each tab gets a random icon from the pool, avoiding duplicates across
# active sessions. Icons persist across /clear (tied to TTY, not session ID).
#
# Options:
#   ENABLE_SESSION_ICONS - "true" (default) or "false"
#   TAVS_SESSION_ICONS   - Bash array of emoji to use as icons
ENABLE_SESSION_ICONS="${ENABLE_SESSION_ICONS:-true}"
TAVS_SESSION_ICONS=(
    "ğŸ™" "ğŸ³" "ğŸª²" "ğŸ¦‰" "ğŸ¢" "ğŸ¦Š" "ğŸ˜" "ğŸ¦‹" "ğŸ¬" "ğŸ¦‘"
    "ğŸ¨" "ğŸ¦­" "ğŸŒ" "ğŸª¼" "ğŸ¦”" "ğŸ¸" "ğŸ§" "ğŸ¦©" "ğŸ" "ğŸ¦"
    "ğŸ¡" "ğŸ¦š" "ğŸª" "ğŸ¦¥" "ğŸ¼"
)

# ==============================================================================
# IDENTITY SYSTEM
# ==============================================================================
# Deterministic dual-identity system: session_id â†’ animal, directory â†’ flag.
# Replaces random-per-TTY icons with registry-based round-robin assignment.
#
# Modes:
#   "dual"   - (Default) Session animal + directory flag in Â«flag|animalÂ» format
#   "single" - Deterministic session animal only (round-robin, 80 animals, no dir icon)
#   "off"    - Legacy random per-TTY behavior (25 animals, exact current behavior)
#
# Backward compatibility:
#   ENABLE_SESSION_ICONS="false" automatically maps to TAVS_IDENTITY_MODE="off"
#   TAVS_SESSION_ICONS user override propagated to TAVS_SESSION_ICON_POOL
# ==============================================================================
TAVS_IDENTITY_MODE="${TAVS_IDENTITY_MODE:-dual}"

# Persistence: where identity registries are stored
#   "ephemeral"  - /tmp/tavs-identity/ (cleared on reboot, fresh icons)
#   "persistent" - ~/.cache/tavs/ (same icon forever, survives reboots)
TAVS_IDENTITY_PERSISTENCE="${TAVS_IDENTITY_PERSISTENCE:-ephemeral}"

# Directory identity source: how directory path is resolved
#   "cwd"      - Use cwd as-is (from hook JSON or $PWD)
#   "git-root" - Normalize to git repository root (groups subdirectories)
TAVS_DIR_IDENTITY_SOURCE="${TAVS_DIR_IDENTITY_SOURCE:-cwd}"

# Worktree detection: show main_flagâ†’worktree_flag when in git worktree
TAVS_DIR_WORKTREE_DETECTION="${TAVS_DIR_WORKTREE_DETECTION:-true}"

# Registry TTL: how long unused entries persist (seconds, 30 days default)
TAVS_IDENTITY_REGISTRY_TTL="${TAVS_IDENTITY_REGISTRY_TTL:-2592000}"

# Directory icon pool type
#   "flags"     - Country flag emoji (~190 flags)
#   "plants"    - Plant/tree emoji (~26, for terminals that can't render flags)
#   "buildings" - Building emoji (~24, alternate fallback)
#   "auto"      - Auto-detect terminal capability (future)
TAVS_DIR_ICON_TYPE="${TAVS_DIR_ICON_TYPE:-flags}"

# Backward compatibility: map ENABLE_SESSION_ICONS=false to identity mode off
[[ "${ENABLE_SESSION_ICONS:-true}" == "false" ]] && TAVS_IDENTITY_MODE="off"

# --- Expanded Session Icon Pool (~80 animals for round-robin) ---
# Used by the identity system (TAVS_IDENTITY_MODE != "off").
# The original TAVS_SESSION_ICONS (25 animals above) is kept for legacy mode.
TAVS_SESSION_ICON_POOL=(
    # Mammals
    "ğŸ•" "ğŸ¶" "ğŸº" "ğŸ¦Š" "ğŸ©" "ğŸˆ" "ğŸ±" "ğŸ†" "ğŸ…" "ğŸ¯"
    "ğŸ¦" "ğŸ’" "ğŸµ" "ğŸ–" "ğŸ·" "ğŸ" "ğŸ´" "ğŸ" "ğŸ" "ğŸ‘"
    "ğŸ—" "ğŸ¦" "ğŸ˜" "ğŸ¼" "ğŸ¨" "ğŸª" "ğŸ«" "ğŸ„" "ğŸ®" "ğŸ‚"
    "ğŸ»" "ğŸƒ" "ğŸ‡" "ğŸ°" "ğŸ¿" "ğŸ¹" "ğŸ­"
    # Birds
    "ğŸ“" "ğŸ”" "ğŸ£" "ğŸ¤" "ğŸ¦ƒ" "ğŸ¦" "ğŸ•Š" "ğŸ¦…" "ğŸ¦‰" "ğŸ¦†" "ğŸ§"
    # Aquatic
    "ğŸ¢" "ğŸ™" "ğŸ¦€" "ğŸ¦" "ğŸ¦ˆ" "ğŸ¬" "ğŸ³" "ğŸ‹" "ğŸŸ" "ğŸ " "ğŸ¡"
    # Reptiles & Bugs
    "ğŸ" "ğŸŠ" "ğŸ¦" "ğŸ›" "ğŸœ" "ğŸŒ" "ğŸ" "ğŸ" "ğŸ¦‹"
    # Additional
    "ğŸ¦­" "ğŸª²" "ğŸ¦‘" "ğŸª¼" "ğŸ¦”" "ğŸ¸" "ğŸ¦©" "ğŸ¦š" "ğŸ¦¥"
)

# --- Directory Icon Pool (~190 flags) ---
TAVS_DIR_ICON_POOL=(
    # Europe (47)
    "ğŸ‡¦ğŸ‡©" "ğŸ‡¦ğŸ‡±" "ğŸ‡¦ğŸ‡²" "ğŸ‡¦ğŸ‡¹" "ğŸ‡§ğŸ‡¦" "ğŸ‡§ğŸ‡ª" "ğŸ‡§ğŸ‡¬" "ğŸ‡§ğŸ‡¾" "ğŸ‡¨ğŸ‡­" "ğŸ‡¨ğŸ‡¾"
    "ğŸ‡¨ğŸ‡¿" "ğŸ‡©ğŸ‡ª" "ğŸ‡©ğŸ‡°" "ğŸ‡ªğŸ‡ª" "ğŸ‡ªğŸ‡¸" "ğŸ‡«ğŸ‡®" "ğŸ‡«ğŸ‡·" "ğŸ‡¬ğŸ‡§" "ğŸ‡¬ğŸ‡ª" "ğŸ‡¬ğŸ‡·"
    "ğŸ‡­ğŸ‡·" "ğŸ‡­ğŸ‡º" "ğŸ‡®ğŸ‡ª" "ğŸ‡®ğŸ‡¸" "ğŸ‡®ğŸ‡¹" "ğŸ‡±ğŸ‡®" "ğŸ‡±ğŸ‡¹" "ğŸ‡±ğŸ‡º" "ğŸ‡±ğŸ‡»" "ğŸ‡²ğŸ‡¨"
    "ğŸ‡²ğŸ‡©" "ğŸ‡²ğŸ‡ª" "ğŸ‡²ğŸ‡°" "ğŸ‡²ğŸ‡¹" "ğŸ‡³ğŸ‡±" "ğŸ‡³ğŸ‡´" "ğŸ‡µğŸ‡±" "ğŸ‡µğŸ‡¹" "ğŸ‡·ğŸ‡´" "ğŸ‡·ğŸ‡¸"
    "ğŸ‡¸ğŸ‡ª" "ğŸ‡¸ğŸ‡®" "ğŸ‡¸ğŸ‡°" "ğŸ‡¸ğŸ‡²" "ğŸ‡ºğŸ‡¦" "ğŸ‡»ğŸ‡¦" "ğŸ‡½ğŸ‡°"
    # The Americas (33)
    "ğŸ‡¦ğŸ‡¬" "ğŸ‡¦ğŸ‡·" "ğŸ‡§ğŸ‡§" "ğŸ‡§ğŸ‡´" "ğŸ‡§ğŸ‡·" "ğŸ‡§ğŸ‡¸" "ğŸ‡§ğŸ‡¿" "ğŸ‡¨ğŸ‡¦" "ğŸ‡¨ğŸ‡±" "ğŸ‡¨ğŸ‡´"
    "ğŸ‡¨ğŸ‡·" "ğŸ‡¨ğŸ‡º" "ğŸ‡©ğŸ‡²" "ğŸ‡©ğŸ‡´" "ğŸ‡ªğŸ‡¨" "ğŸ‡¬ğŸ‡©" "ğŸ‡¬ğŸ‡¹" "ğŸ‡¬ğŸ‡¾" "ğŸ‡­ğŸ‡³" "ğŸ‡­ğŸ‡¹"
    "ğŸ‡¯ğŸ‡²" "ğŸ‡²ğŸ‡½" "ğŸ‡³ğŸ‡®" "ğŸ‡µğŸ‡¦" "ğŸ‡µğŸ‡ª" "ğŸ‡µğŸ‡·" "ğŸ‡µğŸ‡¾" "ğŸ‡¸ğŸ‡·" "ğŸ‡¸ğŸ‡»" "ğŸ‡¹ğŸ‡¹"
    "ğŸ‡ºğŸ‡¸" "ğŸ‡ºğŸ‡¾" "ğŸ‡»ğŸ‡ª"
    # Asia & Middle East (47)
    "ğŸ‡¦ğŸ‡ª" "ğŸ‡¦ğŸ‡«" "ğŸ‡§ğŸ‡©" "ğŸ‡§ğŸ‡­" "ğŸ‡§ğŸ‡³" "ğŸ‡§ğŸ‡¹" "ğŸ‡¨ğŸ‡³" "ğŸ‡­ğŸ‡°" "ğŸ‡®ğŸ‡©" "ğŸ‡®ğŸ‡±"
    "ğŸ‡®ğŸ‡³" "ğŸ‡®ğŸ‡¶" "ğŸ‡®ğŸ‡·" "ğŸ‡¯ğŸ‡´" "ğŸ‡¯ğŸ‡µ" "ğŸ‡°ğŸ‡¬" "ğŸ‡°ğŸ‡­" "ğŸ‡°ğŸ‡µ" "ğŸ‡°ğŸ‡·" "ğŸ‡°ğŸ‡¼"
    "ğŸ‡°ğŸ‡¿" "ğŸ‡±ğŸ‡¦" "ğŸ‡±ğŸ‡§" "ğŸ‡±ğŸ‡°" "ğŸ‡²ğŸ‡²" "ğŸ‡²ğŸ‡³" "ğŸ‡²ğŸ‡»" "ğŸ‡²ğŸ‡¾" "ğŸ‡³ğŸ‡µ" "ğŸ‡´ğŸ‡²"
    "ğŸ‡µğŸ‡­" "ğŸ‡µğŸ‡°" "ğŸ‡µğŸ‡¸" "ğŸ‡¶ğŸ‡¦" "ğŸ‡·ğŸ‡º" "ğŸ‡¸ğŸ‡¦" "ğŸ‡¸ğŸ‡¬" "ğŸ‡¸ğŸ‡¾" "ğŸ‡¹ğŸ‡­" "ğŸ‡¹ğŸ‡¯"
    "ğŸ‡¹ğŸ‡±" "ğŸ‡¹ğŸ‡²" "ğŸ‡¹ğŸ‡·" "ğŸ‡¹ğŸ‡¼" "ğŸ‡ºğŸ‡¿" "ğŸ‡»ğŸ‡³" "ğŸ‡¾ğŸ‡ª"
    # Africa (49)
    "ğŸ‡¦ğŸ‡´" "ğŸ‡§ğŸ‡«" "ğŸ‡§ğŸ‡®" "ğŸ‡§ğŸ‡¯" "ğŸ‡§ğŸ‡¼" "ğŸ‡¨ğŸ‡©" "ğŸ‡¨ğŸ‡«" "ğŸ‡¨ğŸ‡¬" "ğŸ‡¨ğŸ‡®" "ğŸ‡¨ğŸ‡²"
    "ğŸ‡¨ğŸ‡»" "ğŸ‡©ğŸ‡¯" "ğŸ‡©ğŸ‡¿" "ğŸ‡ªğŸ‡¬" "ğŸ‡ªğŸ‡·" "ğŸ‡ªğŸ‡¹" "ğŸ‡¬ğŸ‡¦" "ğŸ‡¬ğŸ‡­" "ğŸ‡¬ğŸ‡²" "ğŸ‡¬ğŸ‡³"
    "ğŸ‡¬ğŸ‡¶" "ğŸ‡°ğŸ‡ª" "ğŸ‡±ğŸ‡·" "ğŸ‡±ğŸ‡¸" "ğŸ‡±ğŸ‡¾" "ğŸ‡²ğŸ‡¦" "ğŸ‡²ğŸ‡¬" "ğŸ‡²ğŸ‡±" "ğŸ‡²ğŸ‡·" "ğŸ‡²ğŸ‡º"
    "ğŸ‡²ğŸ‡¼" "ğŸ‡²ğŸ‡¿" "ğŸ‡³ğŸ‡¦" "ğŸ‡³ğŸ‡ª" "ğŸ‡³ğŸ‡¬" "ğŸ‡·ğŸ‡¼" "ğŸ‡¸ğŸ‡©" "ğŸ‡¸ğŸ‡±" "ğŸ‡¸ğŸ‡³" "ğŸ‡¸ğŸ‡´"
    "ğŸ‡¸ğŸ‡¸" "ğŸ‡¹ğŸ‡©" "ğŸ‡¹ğŸ‡¬" "ğŸ‡¹ğŸ‡³" "ğŸ‡¹ğŸ‡¿" "ğŸ‡ºğŸ‡¬" "ğŸ‡¿ğŸ‡¦" "ğŸ‡¿ğŸ‡²" "ğŸ‡¿ğŸ‡¼"
    # Oceania (14)
    "ğŸ‡¦ğŸ‡º" "ğŸ‡«ğŸ‡¯" "ğŸ‡«ğŸ‡²" "ğŸ‡°ğŸ‡®" "ğŸ‡²ğŸ‡­" "ğŸ‡³ğŸ‡·" "ğŸ‡³ğŸ‡¿" "ğŸ‡µğŸ‡¬" "ğŸ‡µğŸ‡¼" "ğŸ‡¸ğŸ‡§"
    "ğŸ‡¹ğŸ‡´" "ğŸ‡¹ğŸ‡»" "ğŸ‡»ğŸ‡º" "ğŸ‡¼ğŸ‡¸"
)

# --- Fallback Pool A: Plants/Trees (~26) ---
# Used when TAVS_DIR_ICON_TYPE="plants" or for worktree main dirs
TAVS_DIR_FALLBACK_POOL_A=(
    "ğŸŒ³" "ğŸŒ´" "ğŸŒµ" "ğŸŒ²" "ğŸŒ¾" "ğŸŒ¿" "ğŸ€" "ğŸ‹" "ğŸ" "ğŸª´"
    "ğŸŒ¸" "ğŸŒº" "ğŸŒ»" "ğŸŒ¹" "ğŸŒ¼" "ğŸŒ·" "ğŸ’" "ğŸª·" "ğŸŒ±" "ğŸ„"
    "ğŸ" "ğŸ‚" "ğŸƒ" "ğŸª»" "ğŸŒ½" "ğŸŒ¶"
)

# --- Fallback Pool B: Buildings (~24) ---
# Used when TAVS_DIR_ICON_TYPE="buildings" or for worktree alternate dirs
TAVS_DIR_FALLBACK_POOL_B=(
    "ğŸ " "ğŸ¡" "ğŸ¢" "ğŸ£" "ğŸ¤" "ğŸ¥" "ğŸ¦" "ğŸ¨" "ğŸ©" "ğŸª"
    "ğŸ«" "ğŸ¬" "ğŸ­" "ğŸ¯" "ğŸ°" "â›ª" "ğŸ•Œ" "ğŸ•" "ğŸ›•" "â›©"
    "ğŸ—¼" "ğŸ—½" "ğŸ—" "ğŸ›"
)

# ==============================================================================
# COMPACT FACE MODE
# ==============================================================================
# Replace text-based eyes with emoji. Two-signal dashboard: left eye = state
# color, right eye = context fill level (when context eye enabled, the default).
#
# Standard:  Æ[â€¢ â€¢]E ğŸŸ  +2 ğŸ¦Š ~/proj      (text eyes + separate icons)
# Compact:   Æ[ğŸŸ§ ğŸ§€]E +2 ğŸ¦Š ~/proj       (state + context eyes, count outside)
#
# Options:
#   TAVS_FACE_MODE             - "standard" (default) | "compact"
#   TAVS_COMPACT_THEME         - "semantic" | "circles" | "squares" (default) | "mixed"
#   TAVS_COMPACT_CONTEXT_EYE   - "true" (default) | "false" â€” context fill in right eye
#   TAVS_COMPACT_CONTEXT_STYLE - food | food_10 | circle | block | block_max | braille | number | percent
# ==============================================================================
TAVS_FACE_MODE="standard"
TAVS_COMPACT_THEME="squares"

# Compact Context Eye â€” shows context fill level in the right eye
# Auto-enabled when TAVS_FACE_MODE="compact". Disable with "false".
# When enabled: left eye = state color, right eye = context fill indicator.
# When no context data available, right eye falls back to theme status emoji.
TAVS_COMPACT_CONTEXT_EYE="true"

# Context visualization style for the right eye.
# Available: food, food_10, circle, block, block_max, braille, number, percent
TAVS_COMPACT_CONTEXT_STYLE="food"

# --- Semantic theme (default) - Meaningful emoji per state ---
# Format: "left right" pairs, randomly selected per trigger
COMPACT_SEMANTIC_PROCESSING=('ğŸŸ  ğŸŸ ' 'ğŸŸ§ ğŸŸ ' 'ğŸŸ§ ğŸŸ§' 'ğŸ§¡ ğŸ§¡')
COMPACT_SEMANTIC_PERMISSION=('ğŸ”´ ğŸ”´' 'ğŸŸ¥ â­•' 'â­• â­•' 'ğŸŸ¥ ğŸŸ¥')
COMPACT_SEMANTIC_COMPLETE=('âœ… âœ…' 'ğŸŸ¢ ğŸŸ¢' 'ğŸŸ¢ âœ…' 'ğŸŸ© ğŸŸ©')
COMPACT_SEMANTIC_SUBAGENT=('ğŸ”¶ ğŸ”¶' 'ğŸŸ¡ ğŸŸ¡' 'ğŸ’› ğŸ’›' 'ğŸ”¸ ğŸ”¸')
COMPACT_SEMANTIC_TOOL_ERROR=('âŒ âŒ' 'âŒ â­•' 'â›” â›”' 'ğŸ”´ âŒ')
COMPACT_SEMANTIC_COMPACTING=('â™»ï¸ â™»ï¸' 'ğŸ”„ ğŸ”„' 'ğŸ”ƒ â™»ï¸')
COMPACT_SEMANTIC_IDLE_0=('ğŸŸ¢ ğŸŸ¢')
COMPACT_SEMANTIC_IDLE_1=('ğŸŸ£ ğŸŸ£')
COMPACT_SEMANTIC_IDLE_2=('ğŸŸ£ ğŸŸ£' 'ğŸ’œ ğŸŸ£')
COMPACT_SEMANTIC_IDLE_3=('ğŸ’¤ ğŸŸ£')
COMPACT_SEMANTIC_IDLE_4=('ğŸ’¤ ğŸ’¤')
COMPACT_SEMANTIC_IDLE_5=('ğŸ’¤ ğŸ’¤' 'ğŸŒ™ ğŸ’¤')
COMPACT_SEMANTIC_RESET=('â€” â€”')

# --- Circles theme - Uniform round emoji ---
COMPACT_CIRCLES_PROCESSING=('ğŸŸ  ğŸŸ ')
COMPACT_CIRCLES_PERMISSION=('ğŸ”´ ğŸ”´')
COMPACT_CIRCLES_COMPLETE=('ğŸŸ¢ ğŸŸ¢')
COMPACT_CIRCLES_SUBAGENT=('ğŸŸ¡ ğŸŸ¡')
COMPACT_CIRCLES_TOOL_ERROR=('â­• â­•')
COMPACT_CIRCLES_COMPACTING=('ğŸ”µ ğŸ”µ')
COMPACT_CIRCLES_IDLE_0=('ğŸŸ¢ ğŸŸ¢')
COMPACT_CIRCLES_IDLE_1=('ğŸŸ£ ğŸŸ£')
COMPACT_CIRCLES_IDLE_2=('ğŸŸ£ ğŸŸ£')
COMPACT_CIRCLES_IDLE_3=('ğŸŸ£ ğŸŸ£')
COMPACT_CIRCLES_IDLE_4=('ğŸŸ£ ğŸŸ£')
COMPACT_CIRCLES_IDLE_5=('ğŸŸ£ ğŸŸ£')
COMPACT_CIRCLES_RESET=('â€” â€”')

# --- Squares theme - Bold block emoji ---
COMPACT_SQUARES_PROCESSING=('ğŸŸ§ ğŸŸ§')
COMPACT_SQUARES_PERMISSION=('ğŸŸ¥ ğŸŸ¥')
COMPACT_SQUARES_COMPLETE=('ğŸŸ© ğŸŸ©')
COMPACT_SQUARES_SUBAGENT=('ğŸŸ¨ ğŸŸ¨')
COMPACT_SQUARES_TOOL_ERROR=('ğŸŸ¥ ğŸŸ¥')
COMPACT_SQUARES_COMPACTING=('ğŸŸ¦ ğŸŸ¦')
COMPACT_SQUARES_IDLE_0=('ğŸŸ© ğŸŸ©')
COMPACT_SQUARES_IDLE_1=('ğŸŸª ğŸŸª')
COMPACT_SQUARES_IDLE_2=('ğŸŸª ğŸŸª')
COMPACT_SQUARES_IDLE_3=('ğŸŸª ğŸŸª')
COMPACT_SQUARES_IDLE_4=('ğŸŸª ğŸŸª')
COMPACT_SQUARES_IDLE_5=('ğŸŸª ğŸŸª')
COMPACT_SQUARES_RESET=('â€” â€”')

# --- Mixed theme - Asymmetric pairs by default ---
COMPACT_MIXED_PROCESSING=('ğŸŸ§ ğŸŸ ' 'ğŸŸ  ğŸŸ§' 'ğŸ§¡ ğŸŸ ')
COMPACT_MIXED_PERMISSION=('ğŸŸ¥ â­•' 'ğŸ”´ ğŸŸ¥' 'â­• ğŸ”´')
COMPACT_MIXED_COMPLETE=('âœ… ğŸŸ¢' 'ğŸŸ¢ âœ…' 'ğŸŸ© ğŸŸ¢')
COMPACT_MIXED_SUBAGENT=('ğŸ”¶ ğŸŸ¡' 'ğŸŸ¡ ğŸ”¶' 'ğŸ’› ğŸ”¸')
COMPACT_MIXED_TOOL_ERROR=('âŒ â­•' 'ğŸ”´ âŒ' 'â›” ğŸ”´')
COMPACT_MIXED_COMPACTING=('â™»ï¸ ğŸ”„' 'ğŸ”„ â™»ï¸')
COMPACT_MIXED_IDLE_0=('ğŸŸ¢ ğŸŸ£')
COMPACT_MIXED_IDLE_1=('ğŸŸ£ ğŸ’œ')
COMPACT_MIXED_IDLE_2=('ğŸ’œ ğŸŸ£')
COMPACT_MIXED_IDLE_3=('ğŸ’¤ ğŸŸ£')
COMPACT_MIXED_IDLE_4=('ğŸ’¤ ğŸ’¤')
COMPACT_MIXED_IDLE_5=('ğŸŒ™ ğŸ’¤')
COMPACT_MIXED_RESET=('â€” â€”')

# ==============================================================================
# USER TITLE OVERRIDE BEHAVIOR
# ==============================================================================
# How TAVS behaves when it detects a user-set title.
#
# Options:
#   "prefix" - Add face+emoji prefix, keep user's base (recommended)
#   "full"   - Completely respect user title (no changes at all)
#   "ignore" - Always overwrite user title (current legacy behavior)
TAVS_RESPECT_USER_TITLE="prefix"

# ==============================================================================
# TITLE COMPONENT TOGGLES
# ==============================================================================
# Fine-grained control over what appears in the title.
TAVS_TITLE_SHOW_FACE="true"     # Include face in title
TAVS_TITLE_SHOW_STATUS_ICON="true"    # Include status icon in title
TAVS_TITLE_SHOW_SESSION="true"  # Include session ID in fallback
TAVS_TITLE_SHOW_PATH="true"     # Include path in fallback

# ==============================================================================
# SPINNER CONFIGURATION (for TAVS_TITLE_MODE="full")
# ==============================================================================
# When TAVS owns the processing title, these settings control the spinner animation.

# Spinner Style - which animation pattern to use for eyes
# Options: "braille", "circle", "block", "eye-animate", "none", "random"
#   braille     - Rotating dots â ‹ â ™ â ¹ â ¸ (Claude-style)
#   circle      - Filling circles â—‹ â—” â—‘ â—• â—
#   block       - Pulsing vertical bars â– â–‚ â–ƒ â–„ â–… â–† â–‡ â–ˆ
#   eye-animate - Random eye characters from variety pool
#   none        - Use existing face variants (no spinner animation)
#   random      - Random selection per session (recommended)
TAVS_SPINNER_STYLE="random"

# Eye Synchronization Mode - how the two "eyes" in the face animate
# Options: "sync", "opposite", "stagger", "clockwise", "counter", "mirror", "mirror_inv", "random"
#   sync       - Both eyes show same frame
#   opposite   - Eyes half-cycle apart (left/right half-filled)
#   stagger    - Left eye leads, right follows (2 frames behind)
#   clockwise  - Both rotate clockwise (braille)
#   counter    - Both rotate counter-clockwise (braille)
#   mirror     - Left increases while right decreases
#   mirror_inv - Left decreases while right increases
#   random     - Random selection per session (recommended)
TAVS_SPINNER_EYE_MODE="random"

# Session Identity - maintain consistent visual identity per session
# When true, random selections are made once at SessionStart and maintained
# throughout the session for consistent visual "personality"
TAVS_SESSION_IDENTITY="true"

# Spinner Frame Definitions
# Clockwise braille rotation
TAVS_SPINNER_FRAMES_BRAILLE=("â ‹" "â ™" "â ¹" "â ¸" "â ¼" "â ´" "â ¦" "â §" "â ‡" "â ")
# Counter-clockwise (reversed)
TAVS_SPINNER_FRAMES_BRAILLE_CCW=("â " "â ‡" "â §" "â ¦" "â ´" "â ¼" "â ¸" "â ¹" "â ™" "â ‹")
# Circle filling/emptying
TAVS_SPINNER_FRAMES_CIRCLE=("â—‹" "â—”" "â—‘" "â—•" "â—" "â—•" "â—‘" "â—”")
# Block pulsing
TAVS_SPINNER_FRAMES_BLOCK=("â–" "â–‚" "â–ƒ" "â–„" "â–…" "â–†" "â–‡" "â–ˆ" "â–‡" "â–†" "â–…" "â–„" "â–ƒ" "â–‚")
# Eye-only animated characters (large variety pool for random selection)
TAVS_SPINNER_FRAMES_EYE_ANIMATE=("â€¢" "â—¦" "Â·" "Â°" "â—‹" "â—Œ" "â—" "â—" "â—‰" "âŠ™" "âŠš" "â¦¿" "â¦¾" "â—" "â—" "â—‘")

# ==============================================================================
# SPINNER FACE FRAMES (per-agent face outlines for spinner mode)
# ==============================================================================
# When spinner is active, the face's eyes are replaced with spinner frames.
# {L} = left eye placeholder, {R} = right eye placeholder
# These are resolved per-agent like other AGENT_ prefixed variables.

# Claude: Pincer style - Æ[eyes]E
CLAUDE_SPINNER_FACE_FRAME='Æ[{L} {R}]E'

# Gemini: Bear style - Ê•eyesá´¥eyesÊ”
GEMINI_SPINNER_FACE_FRAME='Ê•{L}á´¥{R}Ê”'

# Codex: Cat style - à¸…^eyesï»Œeyes^à¸…
CODEX_SPINNER_FACE_FRAME='à¸…^{L}ï»Œ{R}^à¸…'

# OpenCode: Kaomoji style - (eyes-eyes)
OPENCODE_SPINNER_FACE_FRAME='({L}-{R})'

# Unknown/Default: Kaomoji style
UNKNOWN_SPINNER_FACE_FRAME='({L}-{R})'

# Fallback if no agent-specific frame defined
DEFAULT_SPINNER_FACE_FRAME='[{L} {R}]'

# ==============================================================================
# PALETTE THEMING (OSC 4)
# ==============================================================================
# Optional: Modify the terminal's 16-color ANSI palette for cohesive theming.
# This affects shell prompts, ls colors, git status, and 256-color mode apps.
#
# Options:
#   "false" - Disabled (default) - Background colors only
#   "auto"  - Enable if NOT in TrueColor mode (detects COLORTERM)
#   "true"  - Always enable (affects shell tools even in TrueColor)
#
# NOTE: TrueColor (24-bit RGB) applications bypass the palette entirely.
# Claude Code uses TrueColor by default. To enable palette theming for Claude:
#   TERM=xterm-256color COLORTERM= claude
# ==============================================================================
ENABLE_PALETTE_THEMING="false"

# Default 16-Color ANSI Palette - Dark Mode (Catppuccin FrappÃ©)
# These are used when ENABLE_PALETTE_THEMING is "true" or "auto" + non-TrueColor
# OSC 4 modifies the terminal's ANSI palette (colors 0-15). This affects
# applications using palette indices (16/256-color mode, ANSI escape codes).
PALETTE_DARK_0="#303446"     # Black (Base)
PALETTE_DARK_1="#e78284"     # Red
PALETTE_DARK_2="#a6d189"     # Green
PALETTE_DARK_3="#e5c890"     # Yellow
PALETTE_DARK_4="#8caaee"     # Blue
PALETTE_DARK_5="#f4b8e4"     # Magenta
PALETTE_DARK_6="#81c8be"     # Cyan
PALETTE_DARK_7="#c6d0f5"     # White (Text)
PALETTE_DARK_8="#51576d"     # Bright Black (Surface1)
PALETTE_DARK_9="#ea999c"     # Bright Red
PALETTE_DARK_10="#a6d189"    # Bright Green
PALETTE_DARK_11="#e5c890"    # Bright Yellow
PALETTE_DARK_12="#8caaee"    # Bright Blue
PALETTE_DARK_13="#f4b8e4"    # Bright Magenta
PALETTE_DARK_14="#81c8be"    # Bright Cyan
PALETTE_DARK_15="#a5adce"    # Bright White (Subtext0)

# Default 16-Color ANSI Palette - Light Mode (Catppuccin Latte)
PALETTE_LIGHT_0="#eff1f5"    # Black (Base)
PALETTE_LIGHT_1="#d20f39"    # Red
PALETTE_LIGHT_2="#40a02b"    # Green
PALETTE_LIGHT_3="#df8e1d"    # Yellow
PALETTE_LIGHT_4="#1e66f5"    # Blue
PALETTE_LIGHT_5="#ea76cb"    # Magenta
PALETTE_LIGHT_6="#179299"    # Cyan
PALETTE_LIGHT_7="#4c4f69"    # White (Text)
PALETTE_LIGHT_8="#bcc0cc"    # Bright Black (Surface1)
PALETTE_LIGHT_9="#e64553"    # Bright Red
PALETTE_LIGHT_10="#40a02b"   # Bright Green
PALETTE_LIGHT_11="#df8e1d"   # Bright Yellow
PALETTE_LIGHT_12="#1e66f5"   # Bright Blue
PALETTE_LIGHT_13="#ea76cb"   # Bright Magenta
PALETTE_LIGHT_14="#179299"   # Bright Cyan
PALETTE_LIGHT_15="#6c6f85"   # Bright White (Subtext0)

# Anthropomorphising (ASCII Faces)
ENABLE_ANTHROPOMORPHISING="true"
FACE_POSITION="before"  # Options: "before", "after"

# Status Icons
STATUS_ICON_PROCESSING="ğŸŸ "
STATUS_ICON_PERMISSION="ğŸ”´"
STATUS_ICON_COMPLETE="ğŸŸ¢"
STATUS_ICON_IDLE="ğŸŸ£"
STATUS_ICON_COMPACTING="ğŸ”„"
STATUS_ICON_SUBAGENT="ğŸ”€"          # Shuffle for parallel work
STATUS_ICON_TOOL_ERROR="âŒ"        # Cross for tool failures
STATUS_ICON_RESET="âšª"             # White circle for initial/unused state

# Dynamic Mode Settings
HUE_PROCESSING=30      # Orange
HUE_PERMISSION=0       # Red
HUE_COMPLETE=120       # Green
HUE_IDLE=270           # Purple
HUE_COMPACTING=180     # Teal
HUE_SUBAGENT=50        # Golden-yellow (between orange 30 and yellow 60)
HUE_TOOL_ERROR=15      # Orange-red (between red 0 and orange 30)
HUE_PROCESSING_PLAN=72       # Yellow-green (between yellow 50Â° and green 80Â°)
HUE_PROCESSING_ACCEPT=33     # Barely shifted from 30 (subtle warmth)
HUE_PROCESSING_BYPASS=12     # Red-orange (danger warning)
DYNAMIC_QUERY_TIMEOUT="0.1"
DYNAMIC_DISABLE_SSH="true"

# Idle Timer Configuration
ENABLE_STAGE_INDICATORS="true"
STAGE_DURATIONS=(60 30 30 30 30 30 30)
IDLE_CHECK_INTERVAL=15

# Bell/Notification Settings
ENABLE_BELL_PROCESSING="false"
ENABLE_BELL_PERMISSION="true"
ENABLE_BELL_COMPLETE="false"
ENABLE_BELL_COMPACTING="false"
ENABLE_BELL_SUBAGENT="false"
ENABLE_BELL_TOOL_ERROR="false"

# Advanced Settings
DEBUG_ALL="0"
IDLE_DEBUG="0"
STATE_GRACE_PERIOD_MS=400

# Stylish Backgrounds (Images)
ENABLE_STYLISH_BACKGROUNDS="false"
STYLISH_BACKGROUNDS_DIR="$HOME/.tavs/backgrounds"
STYLISH_SINGLE_IMAGE=""
STYLISH_DISABLE_SSH="true"
STYLISH_SKIP_BG_TINT="false"

# iTerm2-Specific Settings
ITERM2_IMAGE_MODE="aspect_fill"

# Kitty-Specific Settings
KITTY_IMAGE_LAYOUT="scaled"
KITTY_IMAGE_TINT="0.8"

# ==============================================================================
# DEFAULT COLORS (Fallback)
# ==============================================================================
# Used when agent has no specific colors defined.
# Palette: Catppuccin FrappÃ© (dark) / Latte (light)

# --- Dark Mode Background Colors ---
DEFAULT_DARK_BASE="#303446"
DEFAULT_DARK_PROCESSING="#3d3b42"
DEFAULT_DARK_PERMISSION="#3d3440"
DEFAULT_DARK_COMPLETE="#374539"
DEFAULT_DARK_IDLE="#3d3850"
DEFAULT_DARK_COMPACTING="#334545"
DEFAULT_DARK_SUBAGENT="#42402E"    # NEW: Golden-yellow for subagent work
DEFAULT_DARK_TOOL_ERROR="#4A2A1F"  # NEW: Orange-red for tool failures

# --- Light Mode Background Colors ---
DEFAULT_LIGHT_BASE="#eff1f5"
DEFAULT_LIGHT_PROCESSING="#f5e6dc"
DEFAULT_LIGHT_PERMISSION="#f5dde0"
DEFAULT_LIGHT_COMPLETE="#e5f0e5"
DEFAULT_LIGHT_IDLE="#ebe5f5"
DEFAULT_LIGHT_COMPACTING="#e0f0f0"
DEFAULT_LIGHT_SUBAGENT="#F5F0D0"   # NEW: Warm yellow for subagent work
DEFAULT_LIGHT_TOOL_ERROR="#B87050" # NEW: Light orange-red for tool failures

# --- Muted Colors for TrueColor Terminals ---
# These colors have reduced contrast for switching in TrueColor mode.
# Dark muted: lighter than normal dark (~40-45% lightness)
# Light muted: darker than normal light (~55-60% lightness)
# Both converge toward middle tones for minimal jarring when switching.

# Muted Dark Mode (lighter dark - closer to mid-gray)
# Original dark values preserved in comments
DEFAULT_MUTED_DARK_BASE="#4a4e5c"        # was #303446
DEFAULT_MUTED_DARK_PROCESSING="#5a5650"  # was #3d3b42
DEFAULT_MUTED_DARK_PERMISSION="#5a4a4c"  # was #3d3440
DEFAULT_MUTED_DARK_COMPLETE="#4f5a52"    # was #374539
DEFAULT_MUTED_DARK_IDLE="#544f62"        # was #3d3850
DEFAULT_MUTED_DARK_COMPACTING="#4a5858"  # was #334545
DEFAULT_MUTED_DARK_SUBAGENT="#5a5848"    # was #42402E
DEFAULT_MUTED_DARK_TOOL_ERROR="#6a4a3f"  # was #4A2A1F

# Muted Light Mode (darker light - closer to mid-gray)
# Original light values preserved in comments
DEFAULT_MUTED_LIGHT_BASE="#b8bac2"       # was #eff1f5
DEFAULT_MUTED_LIGHT_PROCESSING="#c9b8a8" # was #f5e6dc
DEFAULT_MUTED_LIGHT_PERMISSION="#c9a8ac" # was #f5dde0
DEFAULT_MUTED_LIGHT_COMPLETE="#a8c2a8"   # was #e5f0e5
DEFAULT_MUTED_LIGHT_IDLE="#b8aac8"       # was #ebe5f5
DEFAULT_MUTED_LIGHT_COMPACTING="#a8c2c2" # was #e0f0f0
DEFAULT_MUTED_LIGHT_SUBAGENT="#c8c4a0"   # was #F5F0D0
DEFAULT_MUTED_LIGHT_TOOL_ERROR="#c09070" # was #B87050

# --- Mode-Aware Processing Colors (permission mode variants) ---
# Plan mode: yellow-green tinge (read-only, thinking mode)
DEFAULT_DARK_PROCESSING_PLAN="#444837"
DEFAULT_LIGHT_PROCESSING_PLAN="#E7E9DE"
DEFAULT_MUTED_DARK_PROCESSING_PLAN="#5C5E54"
DEFAULT_MUTED_LIGHT_PROCESSING_PLAN="#BEBFB9"

# AcceptEdits/dontAsk mode: barely warmer (auto-approve)
DEFAULT_DARK_PROCESSING_ACCEPT="#3E3B40"
DEFAULT_LIGHT_PROCESSING_ACCEPT="#F6E4D8"
DEFAULT_MUTED_DARK_PROCESSING_ACCEPT="#5B564E"
DEFAULT_MUTED_LIGHT_PROCESSING_ACCEPT="#CAB8A6"

# BypassPermissions mode: reddish danger tinge
DEFAULT_DARK_PROCESSING_BYPASS="#462E24"
DEFAULT_LIGHT_PROCESSING_BYPASS="#F2D2C4"
DEFAULT_MUTED_DARK_PROCESSING_BYPASS="#5E4238"
DEFAULT_MUTED_LIGHT_PROCESSING_BYPASS="#C4A898"

# ==============================================================================
# AGENT: CLAUDE CODE
# ==============================================================================
CLAUDE_AGENT_NAME="Claude Code"

# Background Colors - Dark Mode (Catppuccin Frappe with Anthropic purple accents)
CLAUDE_DARK_BASE="#2E3440"
CLAUDE_DARK_PROCESSING="#473D2F"
CLAUDE_DARK_PERMISSION="#4A2021"
CLAUDE_DARK_COMPLETE="#473046"
CLAUDE_DARK_IDLE="#443147"
CLAUDE_DARK_COMPACTING="#2B4645"
CLAUDE_DARK_SUBAGENT="#484530"     # Golden-yellow for subagent work
CLAUDE_DARK_TOOL_ERROR="#4A2A1F"   # Orange-red for tool failures

# Background Colors - Light Mode
CLAUDE_LIGHT_BASE="#ECEFF4"
CLAUDE_LIGHT_PROCESSING="#F5E0D0"
CLAUDE_LIGHT_PERMISSION="#F5D0D0"
CLAUDE_LIGHT_COMPLETE="#E8E0F0"
CLAUDE_LIGHT_IDLE="#E8E0F0"
CLAUDE_LIGHT_COMPACTING="#D8F0F0"
CLAUDE_LIGHT_SUBAGENT="#F5ECD0"    # Warm yellow for subagent work
CLAUDE_LIGHT_TOOL_ERROR="#B87050"  # Light orange-red for tool failures

# Mode-Aware Processing Colors (permission mode variants)
# Plan mode: yellow-green tinge (~72Â° hue, visible but not overly green)
CLAUDE_DARK_PROCESSING_PLAN="#434A2D"
CLAUDE_LIGHT_PROCESSING_PLAN="#EEF5CF"
CLAUDE_MUTED_DARK_PROCESSING_PLAN="#5C604F"
CLAUDE_MUTED_LIGHT_PROCESSING_PLAN="#C2C6B0"

# AcceptEdits/dontAsk mode: barely warmer (subtle saturation increase)
CLAUDE_DARK_PROCESSING_ACCEPT="#493D2D"
CLAUDE_LIGHT_PROCESSING_ACCEPT="#F7DECE"
CLAUDE_MUTED_DARK_PROCESSING_ACCEPT="#5F584E"
CLAUDE_MUTED_LIGHT_PROCESSING_ACCEPT="#C7B8AF"

# BypassPermissions mode: reddish danger tinge (~12Â° hue)
CLAUDE_DARK_PROCESSING_BYPASS="#4B312A"
CLAUDE_LIGHT_PROCESSING_BYPASS="#F7D5CE"
CLAUDE_MUTED_DARK_PROCESSING_BYPASS="#60514C"
CLAUDE_MUTED_LIGHT_PROCESSING_BYPASS="#C7B3AF"

# Faces - Combined claudA-F pincer variants (6 per state for randomization)
CLAUDE_FACES_PROCESSING=(
    'Æ[â€¢ â€¢]E'
    'Æ[â€¢ â—•]E'
    'Æ[â–  â– ]E'
    'Æ[â—” â—”]E'
    'Æ[ï½¡ ï½¡]E'
    'Æ[. .]E'
)
CLAUDE_FACES_PERMISSION=(
    'Æ[Â° Â°]E'
    'Æ[â—‹ â—‹]E'
    'Æ[â–¡ â–¡]E'
    'Æ[Ê˜ Ê˜]E'
    'Æ[Õ Õ]E'
    'Æ[o o]E'
)
CLAUDE_FACES_COMPLETE=(
    'Æ[âœ¦ âœ¦]E'
    'Æ[â˜… â˜…]E'
    'Æ[âœ§ âœ§]E'
    'Æ[â€ â€]E'
    'Æ[âœ¿ âœ¿]E'
    'Æ[* *]E'
)
CLAUDE_FACES_COMPACTING=(
    'Æ[@ @]E'
    'Æ[â— â—]E'
    'Æ[â–£ â–£]E'
    'Æ[Ã— Ã—]E'
    'Æ[ï¼  ï¼ ]E'
    'Æ[@ @]E'
)
CLAUDE_FACES_RESET=(
    'Æ[â€¢ â€¢]E'
    'Æ[â€¢ â€¢]E'
    'Æ[â–  â– ]E'
    'Æ[â—” â—”]E'
    'Æ[ï½¡ ï½¡]E'
    'Æ[. .]E'
)
CLAUDE_FACES_IDLE_0=(
    'Æ[â—• â—•]E'
    'Æ[â—‰ â—‰]E'
    'Æ[â–¢ â–¢]E'
    'Æ[â— â—]E'
    'Æ[â—  â— ]E'
    'Æ[O O]E'
)
CLAUDE_FACES_IDLE_1=(
    'Æ[â€¢ â€¢]E'
    'Æ[â€¢ â€¢]E'
    'Æ[â–  â– ]E'
    'Æ[â€¢ â€¢]E'
    'Æ[ï½¡ ï½¡]E'
    'Æ[. .]E'
)
CLAUDE_FACES_IDLE_2=(
    'Æ[á´— á´—]E'
    'Æ[áµ• áµ•]E'
    'Æ[â–± â–±]E'
    'Æ[áµ” áµ”]E'
    'Æ[áµ• áµ•]E'
    'Æ[^ ^]E'
)
CLAUDE_FACES_IDLE_3=(
    'Æ[Â¬ Â¬]E'
    'Æ[ï¿¢ ï¿¢]E'
    'Æ[â–¨ â–¨]E'
    'Æ[à²  à² ]E'
    'Æ[âŒ£ âŒ£]E'
    'Æ[- -]E'
)
CLAUDE_FACES_IDLE_4=(
    'Æ[- -]E zZ'
    'Æ[ï¼ ï¼]E zZ'
    'Æ[â”€ â”€]E zZ'
    'Æ[âˆª âˆª]E zZ'
    'Æ[á´— á´—]E zZ'
    'Æ[- -]E zZ'
)
CLAUDE_FACES_IDLE_5=(
    'Æ[= =]E á¶»á¶»'
    'Æ[ï¼¿ ï¼¿]E á¶»á¶»'
    'Æ[â• â•]E á¶»á¶»'
    'Æ[âˆ© âˆ©]E á¶»á¶»'
    'Æ[ï¸¶ ï¸¶]E á¶»á¶»'
    'Æ[_ _]E á¶»á¶»'
)
# NEW: Subagent faces - arrows/parallel indicators
CLAUDE_FACES_SUBAGENT=(
    'Æ[â‡† â‡†]E'
    'Æ[â†” â†”]E'
    'Æ[âŸº âŸº]E'
    'Æ[â‡„ â‡„]E'
    'Æ[â†º â†º]E'
    'Æ[âŸ³ âŸ³]E'
)
# NEW: Tool error faces - X marks
CLAUDE_FACES_TOOL_ERROR=(
    'Æ[âœ• âœ•]E'
    'Æ[Ã— Ã—]E'
    'Æ[âœ— âœ—]E'
    'Æ[â¨¯ â¨¯]E'
    'Æ[âœ– âœ–]E'
    'Æ[â•³ â•³]E'
)

# ==============================================================================
# AGENT: GEMINI CLI
# ==============================================================================
GEMINI_AGENT_NAME="Gemini CLI"

# Background Colors - Dark Mode (Cooler tones, Google blue influence)
GEMINI_DARK_BASE="#2B3540"
GEMINI_DARK_PROCESSING="#3D4A47"
GEMINI_DARK_PERMISSION="#4A2028"
GEMINI_DARK_COMPLETE="#304640"
GEMINI_DARK_IDLE="#3B3F4A"
GEMINI_DARK_COMPACTING="#264548"
GEMINI_DARK_SUBAGENT="#404838"
GEMINI_DARK_TOOL_ERROR="#4A2A1F"

# Background Colors - Light Mode
GEMINI_LIGHT_BASE="#EBF0F4"
GEMINI_LIGHT_PROCESSING="#D8E8E0"
GEMINI_LIGHT_PERMISSION="#F0D0D8"
GEMINI_LIGHT_COMPLETE="#D0F0E8"
GEMINI_LIGHT_IDLE="#D8E0F5"
GEMINI_LIGHT_COMPACTING="#D0F0F5"
GEMINI_LIGHT_SUBAGENT="#EEF0D0"
GEMINI_LIGHT_TOOL_ERROR="#B87050"

# Faces - Bear style
GEMINI_FACES_PROCESSING=('Ê•â€¢á´¥â€¢Ê”')
GEMINI_FACES_PERMISSION=('Ê•à¹á´¥à¹Ê”')
GEMINI_FACES_COMPLETE=('Ê•â™¥á´¥â™¥Ê”')
GEMINI_FACES_COMPACTING=('Ê•â€¢_â€¢Ê”')
GEMINI_FACES_RESET=('Ê•-á´¥-Ê”')
GEMINI_FACES_IDLE_0=('Ê•â€¢á´¥â€¢Ê”')
GEMINI_FACES_IDLE_1=('Ê•â€¾á´¥â€¾Ê”')
GEMINI_FACES_IDLE_2=('Ê•ï¸¶á´¥ï¸¶Ê”')
GEMINI_FACES_IDLE_3=('Ê•Â¬á´¥Â¬Ê”')
GEMINI_FACES_IDLE_4=('Ê•-á´¥-Ê”zZ')
GEMINI_FACES_IDLE_5=('Ê•ï¸¶á´¥ï¸¶Ê”á¶»á¶»')
GEMINI_FACES_SUBAGENT=('Ê•â‡†á´¥â‡†Ê”')
GEMINI_FACES_TOOL_ERROR=('Ê•âœ•á´¥âœ•Ê”')

# ==============================================================================
# AGENT: CODEX CLI
# ==============================================================================
CODEX_AGENT_NAME="Codex CLI"

# Background Colors - Dark Mode (Neutral, desaturated tones)
CODEX_DARK_BASE="#303035"
CODEX_DARK_PROCESSING="#454035"
CODEX_DARK_PERMISSION="#452830"
CODEX_DARK_COMPLETE="#354538"
CODEX_DARK_IDLE="#3A3540"
CODEX_DARK_COMPACTING="#304040"
CODEX_DARK_SUBAGENT="#454030"
CODEX_DARK_TOOL_ERROR="#4A2A1F"

# Background Colors - Light Mode
CODEX_LIGHT_BASE="#F0F0F2"
CODEX_LIGHT_PROCESSING="#E8E0D8"
CODEX_LIGHT_PERMISSION="#E8D8D8"
CODEX_LIGHT_COMPLETE="#D8E8D8"
CODEX_LIGHT_IDLE="#E0D8E8"
CODEX_LIGHT_COMPACTING="#D8E8E8"
CODEX_LIGHT_SUBAGENT="#F0ECD0"
CODEX_LIGHT_TOOL_ERROR="#B87050"

# Faces - Cat style
CODEX_FACES_PROCESSING=('à¸…^â€¢ï»Œâ€¢^à¸…')
CODEX_FACES_PERMISSION=('à¸…^â—‰ï»Œâ—‰^à¸…')
CODEX_FACES_COMPLETE=('à¸…^â™¥ï»Œâ™¥^à¸…')
CODEX_FACES_COMPACTING=('à¸…^â€¢_â€¢^à¸…')
CODEX_FACES_RESET=('à¸…^-ï»Œ-^à¸…')
CODEX_FACES_IDLE_0=('à¸…^â€¢ï»Œâ€¢^à¸…')
CODEX_FACES_IDLE_1=('à¸…^â€¾ï»Œâ€¾^à¸…')
CODEX_FACES_IDLE_2=('à¸…^ï¸¶ï»Œï¸¶^à¸…')
CODEX_FACES_IDLE_3=('à¸…^Â¬ï»ŒÂ¬^à¸…')
CODEX_FACES_IDLE_4=('à¸…^-ï»Œ-^à¸…zZ')
CODEX_FACES_IDLE_5=('à¸…^ï¸¶ï»Œï¸¶^à¸…á¶»á¶»')
CODEX_FACES_SUBAGENT=('à¸…^â‡†ï»Œâ‡†^à¸…')
CODEX_FACES_TOOL_ERROR=('à¸…^âœ•ï»Œâœ•^à¸…')

# ==============================================================================
# AGENT: OPENCODE
# ==============================================================================
OPENCODE_AGENT_NAME="OpenCode"

# Background Colors - Dark Mode (Warmer tones, amber/earth feel)
OPENCODE_DARK_BASE="#3A3530"
OPENCODE_DARK_PROCESSING="#504030"
OPENCODE_DARK_PERMISSION="#502520"
OPENCODE_DARK_COMPLETE="#404538"
OPENCODE_DARK_IDLE="#453840"
OPENCODE_DARK_COMPACTING="#354540"
OPENCODE_DARK_SUBAGENT="#4A4528"
OPENCODE_DARK_TOOL_ERROR="#4A2A1F"

# Background Colors - Light Mode
OPENCODE_LIGHT_BASE="#F5F0E8"
OPENCODE_LIGHT_PROCESSING="#F8E0C8"
OPENCODE_LIGHT_PERMISSION="#F8D0C8"
OPENCODE_LIGHT_COMPLETE="#E8F0D8"
OPENCODE_LIGHT_IDLE="#F0E0E8"
OPENCODE_LIGHT_COMPACTING="#E0F0E8"
OPENCODE_LIGHT_SUBAGENT="#F8F0C8"
OPENCODE_LIGHT_TOOL_ERROR="#B87050"

# Faces - Minimal kaomoji
OPENCODE_FACES_PROCESSING=('(Â°-Â°)')
OPENCODE_FACES_PERMISSION=('(Â°â–¡Â°)')
OPENCODE_FACES_COMPLETE=('(^â€¿^)')
OPENCODE_FACES_COMPACTING=('(@_@)')
OPENCODE_FACES_RESET=('(-_-)')
OPENCODE_FACES_IDLE_0=('(â€¢â€¿â€¢)')
OPENCODE_FACES_IDLE_1=('(â€¿â€¿)')
OPENCODE_FACES_IDLE_2=('(ï¸¶â€¿ï¸¶)')
OPENCODE_FACES_IDLE_3=('(Â¬â€¿Â¬)')
OPENCODE_FACES_IDLE_4=('(-.-)zzZ')
OPENCODE_FACES_IDLE_5=('(ï¸¶.ï¸¶)á¶»á¶»')
OPENCODE_FACES_SUBAGENT=('(â‡†-â‡†)')
OPENCODE_FACES_TOOL_ERROR=('(âœ•_âœ•)')

# ==============================================================================
# AGENT: UNKNOWN (Fallback for unrecognized agents)
# ==============================================================================
UNKNOWN_AGENT_NAME="Unknown Agent"

# Colors - Uses DEFAULT_* colors (both background and foreground)

# Faces - Minimal kaomoji (same as OpenCode for universal compatibility)
UNKNOWN_FACES_PROCESSING=('(Â°-Â°)')
UNKNOWN_FACES_PERMISSION=('(Â°â–¡Â°)')
UNKNOWN_FACES_COMPLETE=('(^â€¿^)')
UNKNOWN_FACES_COMPACTING=('(@_@)')
UNKNOWN_FACES_RESET=('(-_-)')
UNKNOWN_FACES_IDLE_0=('(â€¢â€¿â€¢)')
UNKNOWN_FACES_IDLE_1=('(â€¿â€¿)')
UNKNOWN_FACES_IDLE_2=('(ï¸¶â€¿ï¸¶)')
UNKNOWN_FACES_IDLE_3=('(Â¬â€¿Â¬)')
UNKNOWN_FACES_IDLE_4=('(-.-)zzZ')
UNKNOWN_FACES_IDLE_5=('(ï¸¶.ï¸¶)á¶»á¶»')
UNKNOWN_FACES_SUBAGENT=('(â‡†-â‡†)')
UNKNOWN_FACES_TOOL_ERROR=('(âœ•_âœ•)')
